var e=Object.defineProperty,t=(t,i,n)=>(((t,i,n)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n})(t,"symbol"!=typeof i?i+"":i,n),n);import{T as i,n,B as s,G as r,o,V as a,R as c,q as h,P as l,S as d,A as y,O as u,W as w,s as x}from"./libs.ec5fd20d.js";import{n as m}from"./vendor.e75a9f0e.js";const p=[{y:0,x:0},{y:0,x:1},{y:0,x:2},{y:0,x:5},{y:0,x:6},{y:0,x:7},{y:0,x:8},{y:1,x:2},{y:1,x:8},{y:2,x:0},{y:2,x:1},{y:2,x:2},{y:2,x:3},{y:2,x:6},{y:2,x:7},{y:2,x:8},{y:2,x:10},{y:3,x:2},{y:3,x:3},{y:3,x:7},{y:3,x:10},{y:4,x:2},{y:4,x:3},{y:4,x:6},{y:4,x:7},{y:4,x:8},{y:4,x:9},{y:4,x:10},{y:4,x:11},{y:5,x:0},{y:5,x:1},{y:5,x:2},{y:5,x:3},{y:5,x:7},{y:5,x:10},{y:6,x:1},{y:6,x:4},{y:6,x:5},{y:6,x:6},{y:6,x:7},{y:6,x:9},{y:7,x:1},{y:7,x:5},{y:7,x:8},{y:7,x:9},{y:7,x:10},{y:7,x:11},{y:8,x:0},{y:8,x:1},{y:8,x:2},{y:8,x:3},{y:8,x:4},{y:8,x:5},{y:8,x:9}],f=new i,g=f.load("/static/img/block-d7f24ee6.jpg"),v=f.load("/static/img/block_active-99293ae4.jpg");class C{constructor(e,t,i){this.map=p,this.container=e,this.grid=[12,9],this.size=120,this.width=t,this.height=i,this.clickObjects=[],this.scene=null,this.camera=null,this.renderer=null,this.control=null;const[n,s]=this.grid;this.centerVector=new a(n*this.size/2,0,s*this.size/2)}get row(){return this.grid[0]}get col(){return this.grid[1]}init(){const e=this,t=new c,i=new h;this.initScene(),this.initCamera(),this.initLight(),this.initRenderer(),this.initHelper(),this.initControl(),this.initCanvas(),this.resize=function(){e.renderer.setSize(window.innerWidth,window.innerHeight),e.camera.aspect=window.innerWidth/window.innerHeight,e.control.update(),e.camera.updateProjectionMatrix()},this.pointerdown=function(n){n.preventDefault(),i.x=n.clientX/e.renderer.domElement.clientWidth*2-1,i.y=-n.clientY/e.renderer.domElement.clientHeight*2+1,t.setFromCamera(i,e.camera);const s=t.intersectObjects(e.clickObjects);s.length>0&&e.onPointDown(s[0].object)},this.container.addEventListener("pointerdown",this.pointerdown),window.addEventListener("resize",this.resize),window.dispatchEvent(new Event("resize"))}initCamera(){this.camera=new l(30,this.width/this.height,.1,8e3),this.camera.position.set(800,800,800),this.camera.lookAt(this.centerVector)}initScene(){this.scene=new d}initHelper(){const e=new y(800);this.scene.add(e)}initControl(){const e=this;this.control=new u(this.camera,this.renderer.domElement),this.control.target.set(this.centerVector.x,this.centerVector.y,this.centerVector.z),this.control.update(),this.change=function(){e.renderer.render(e.scene,e.camera)},this.control.addEventListener("change",this.change)}initRenderer(){const e=this;this.renderer=new w({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(13887227,1),this.renderer.setAnimationLoop((function(){e.renderer.render(e.scene,e.camera)})),this.container.appendChild(this.renderer.domElement)}initLight(){const e=new x(4095,1);e.position.set(400,0,0),this.scene.add(e)}initCanvas(){}onPointDown(){}destroy(){window.removeEventListener("resize",this.resize),this.container.removeEventListener("pointerdown",this.pointerdown),this.control.removeEventListener("change",this.change),this.control.dispose(),this.gui.destroy(),this.renderer.dispose(),this.scene.clear()}}function D(e,t){return"".concat(e,"-").concat(t)}function b(e){return e.split("-").map((e=>Number(e)))}class z extends C{constructor(){super(...arguments),t(this,"tips",new Map([["21222324","赫拉利将告诉你人类是如何从动物变成上帝"],["40414243","对两次世界大战的哲学思考，直面存在的危机"],["81828384","看萧红写的这书名还以为是一条河的历史"],["9091","鲁迅先生的短篇小说集，里面有《狂人日记》"],["64656667","天下合久必分，分久必合"],["46474849","与达尔文《物种起源论》及哥白尼《天体运行论》并称为人类三大思想革命的经典之作"],["262728","三位艺术天才的非凡人生，罗曼罗兰著"],["5678","证明你上过中学的又一个有力佐证，冰心奶奶如是说"],["11121","我们都是故事外的人——阿尔贝·加缪"],["13233343","一种追求简单生活的价值观"],["415161718191","余华手下一本关于记忆的长篇小说"],["647484","走遍万水千山，泪尽撒哈拉"],["2737475767","达康书记别低头，皇冠会掉"],["81828","中国四大名著之一"]])),t(this,"units",[]),t(this,"emptyMaterial",new n({color:14922589,name:"emptyUnitMaterial"})),t(this,"material",new n({map:g,name:"unitMaterial"})),t(this,"activeMaterial",new n({map:v,name:"activeUnitMaterial"}))}onPointDown(e){if(e.userData.empty)return;this.resetCollection(this.units,e),e.userData.down=!e.userData.down;const t=e.userData.down,i=e.userData.selectRow;console.log("selectRow",i),console.log("down",t);const[n,s]=b(e.name),r=this.collectionUnit(n,s,!0),o=this.collectionUnit(n,s,!1);t&&i?this.renderColCollection(n,s,[r,o]):this.renderRowCollection(n,s,[r,o])}renderColCollection(e,t,[i,n]){const s=this.aroundUnit(e,t,n,!1);if(s.length<2)this.renderRowCollection(e,t,[i,n],!0);else for(const r of s)r.userData.selectRow=!1,r.material=this.activeMaterial}renderRowCollection(e,t,[i,n]){const s=this.aroundUnit(e,t,i,!0);if(s.length<2)return this.renderColCollection(e,t,[i,n],!1);for(const r of s)r.userData.selectRow=!0,r.material=this.activeMaterial}resetCollection(e,t){const i=this,n=e.filter((function(e){return!e.userData.empty}));for(const s of n)s.material=i.material,s.userData.down=!1}collectionUnit(e,t,i){return this.units.filter((function(n){const[s,r]=b(n.name);return i?r===t:s===e}))}aroundUnit(e,t,i,n){const s=[],r=i.length,o=n?e:t;for(let a=o;a<r;a++){const e=i[a];if(e&&e.userData.empty)break;s.push(e)}for(let a=o-1;a>=0;a--){const e=i[a];if(e&&e.userData.empty)break;s.push(e)}return s}initCanvas(){const e=new s(100,100,100),t=new r,[i,n]=this.grid;for(let s=0;s<i;s++)for(let i=0;i<n;i++){let n=new o(e,this.emptyMaterial);for(const t of this.map)if(t.x===s&&t.y===i){n=new o(e,this.material);break}n.position.set(120*s,0,120*i),n.name=D(s,i),n.userData.down=!1,n.userData.selectRow=null,"emptyUnitMaterial"===n.material.name&&(n.userData.empty=!0),this.clickObjects.push(n),this.units.push(n),t.add(n)}const a=new r;a.add(t),t.position.set(-this.centerVector.x,0,-this.centerVector.z),a.position.set(this.centerVector.x,0,this.centerVector.z),this.scene.add(a)}}var R=function(){return(0,this._self._c)("div",{staticClass:"three-container"})},E=[];const j=m({name:"ThreeIndex",mounted(){const e=new z(this.$el,window.innerWidth,window.innerHeight);e.init(),this.$on("hook:beforeDestroy",(function(){e.destroy()}))}},R,E,!1,null,null,null,null).exports;export{j as default};
//# sourceMappingURL=index.2c1b825c.js.map
