{"version":3,"mappings":"wzCAoCAA,EAAA,CACA,CACAC,MAAA,OACA,MAAAC,GACA,OAAAC,EAAA,CAAAC,MAAA,CAAAH,MAAAI,KAAAJ,QAAA,WACA,GAEA,CACAA,MAAA,OACA,MAAAC,GACA,OAAAC,EAAA,CAAAC,MAAA,CAAAH,MAAAI,KAAAJ,QAAA,WACA,GAEA,CACAA,MAAA,KACA,MAAAC,GACA,OAAAC,EAAA,CAAAC,MAAA,CAAAH,MAAAI,KAAAJ,QAAA,WACA,GAEA,CACAA,MAAA,MACA,MAAAC,GACA,OAAAI,EACA,CAAAC,SAAA,EAAAH,MAAA,CAAAH,MAAAI,KAAAJ,MAAAO,SAAA,CAAAC,EAAA,EAAAC,EAAA,MACA,CACAP,EAAA,CAAAC,MAAA,CAAAH,MAAA,oBACAE,EAAA,CAAAC,MAAA,CAAAH,MAAA,MAAAO,SAAA,CAAAC,EAAA,GAAAC,EAAA,mBAEA,WAEA,GAEA,CACAT,MAAA,MACA,MAAAC,GACA,OAAAC,EACA,CACAQ,KAAA,iBACAP,MAAA,CACAH,MAAAI,KAAAJ,MACAW,QAAA,CACA,CAAAX,MAAA,MAAAY,MAAA,OACA,CAAAZ,MAAA,MAAAY,MAAA,OACA,CAAAZ,MAAA,MAAAY,MAAA,UAIA,WAEA,IAOA,IAAAC,EAAA,eA4BA,CACAH,KAAA,mBACAI,WAAA,CACAC,aAAA,IAAAC,GAAA,IAAAC,OAAA,iTACAC,aAAA,IAAAF,GAAA,IAAAC,OAAA,8XACAE,cAAA,IAAAH,GAAA,IAAAC,OAAA,oTAEA,KAAAG,GACA,MAAAC,EAAAC,IACAD,EAAAE,KAAAb,KAAA,KAQA,OAxCA,SAAAc,GACA,IAAAC,EAAA,EAEA,OAAAD,EAAAE,KAAA,SAAAC,EAAAC,GACA,MAAAC,EAAAF,EAAA1B,QAAA,GAeA,OAbA4B,EAAAC,IAAAL,IACAI,EAAAE,GAAAC,EAAAH,EAAAC,KACAD,EAAAI,SAAA,EACAJ,EAAA1B,MAAAI,SAAAC,EAAA,GACAqB,EAAA1B,MAAAI,SAAAE,EAAA,IAAAmB,EAEAC,EAAAK,UACAL,EAAAK,SAAAC,SAAA,SAAAR,GACAA,EAAAG,IAAAL,IACAE,EAAAI,GAAAC,EAAAL,EAAAG,IACA,IAGAD,CACA,GACA,CAYAO,CAAArC,GAEAoC,SAAA,SAAAR,EAAAC,GACAP,EAAAP,WAAAuB,IAAAT,EAAAD,GACAN,EAAAiB,SAAA,CACA,IAEA,CAAAjB,QACA,EACAG,KAAA,KACA,CACAe,eAAA,IAGAC,SAAA,CACA,aAAAC,GACA,OACAC,gBAAAtC,KAAAiB,MAAAsB,QAAAC,KAAA,KACAC,eAAAzC,KAAAiB,MAAAsB,QAAAG,IAAA,KACAC,iBAAA3C,KAAAiB,MAAAsB,QAAAK,MAAA,KACAC,kBAAA7C,KAAAiB,MAAAsB,QAAAO,OAAA,KACAC,MAAA/C,KAAAiB,MAAAE,KAAA4B,MAAA,KACAC,OAAAhD,KAAAiB,MAAAE,KAAA6B,OAAA,KAEA,GAEAC,QAAA,CACA,IAAAC,GAEA,OADAlD,KAAAmC,eAAA,EACA,IAAAgB,SAAAC,IACA3C,EAAA2C,CAAA,GAEA,EAIA,MAAAC,CAAAC,GACAtD,KAAAmC,eAAA,EACA1B,EAAA6C,EACA,wCCtKMC,EAAyBC,EAAIC,OAAOC,GAK1C,IAAIC,EAAiC,eC0BrC,CACArD,KAAA,qBACAsD,OAAA,CACAC,EAAA,CACAC,QAdA,SAAAC,GAEA,OADAC,QAAAC,IAAAF,GACAD,EACAI,MAAAC,KAAA,CAAAC,OAAAL,EAAAK,QAAA,MAAAC,EAAAC,KAAA,CACAhE,KAAA,MACAiE,QAAA,iBAAAC,OAAAF,EAAA,UAGA,EAOAG,WAAA,KAGAzD,MAAA,KAGA,CACA0D,KAHA,CAAAC,YAAA,QAMA,OAAAC,GACA5E,KAAA0E,KAAAC,YAAA3E,KAAA6E,iBAAAF,YACA3E,KAAA8E,QACA,EACA7B,QAAA,CACA8B,aAAA,KDxCOpB,IACHA,EAAiC,IAAIJ,EACrCI,EAA+BqB,SAEtBC,SAAAC,KAAKC,YAAYxB,EAA+ByB,MAGpDzB,EAA+BT","names":["mockComponents","label","create","createBuiltinComponent","props","this","createBuiltinComponentGroup","builtin","position","x","y","name","options","value","resolvePromise","components","BuiltinInput","__vitePreload","import","BuiltinGroup","BuiltinSelect","setup","store","useStore","size","data","index","map","item","i","component","uid","id","createId","visible","children","forEach","mockData","set","changes","dialogVisible","computed","documentStyle","borderLeftWidth","padding","left","borderTopWidth","top","borderRightWidth","right","borderBottomWidth","bottom","width","height","methods","open","Promise","resolve","action","type","TemplateDocumentPrompt","Vue","extend","TemplateDocumentPromptConstructor","templateDocumentPromptInstance","mixins","pageMixin","request","param","console","log","Array","from","length","v","k","address","concat","immediate","form","mechanismId","created","currentMechanism","search","editDocument","$mount","document","body","appendChild","$el"],"sources":["../../../src/views/template/components/template-document/render.vue","../../../src/views/template/components/template-document/index.js","../../../src/views/user/components/reportTemplate.vue"],"sourcesContent":["<template lang=\"pug\">\nel-dialog(\n  title=\"编辑模板\"\n  :visible.sync=\"dialogVisible\"\n  :close-on-click-modal=\"false\"\n  :close-on-press-escape=\"false\"\n  :show-close=\"false\"\n  :width=\"store.size.width + 50 + 'px'\")\n  section(:style=\"{ height: '55vh', overflowY: 'auto' }\" style=\"background-color: #fff;\")\n    .template-document(:style=\"documentStyle\")\n      template(v-for=\"component of store.componentsData\")\n        component(\n          group\n          mode=\"element\"\n          :key=\"component.id\"\n          :is=\"component.name\"\n          :children=\"component.children\"\n          v-bind=\"component.props\"\n          v-if=\"component.name === 'builtin-group'\")\n        component(\n          mode=\"element\"\n          :key=\"component.id\"\n          :is=\"component.name\"\n          v-model=\"component.value\"\n          v-bind=\"component.props\"\n          v-else)\n\n  div(slot=\"footer\")\n    el-button(size=\"small\" @click=\"action('cancel')\") 取 消\n    el-button(type=\"primary\" size=\"small\" @click=\"action('ok')\") 确 定\n</template>\n\n<script>\nimport { createBuiltinComponent, createBuiltinComponentGroup, createId } from '@/views/template/utils'\nimport { useStore } from '@/views/template/hooks/useStore'\n\nconst mockComponents = [\n  {\n    label: '病例名称',\n    create() {\n      return createBuiltinComponent({ props: { label: this.label } }, 'document')\n    }\n  },\n  {\n    label: '产前编号',\n    create() {\n      return createBuiltinComponent({ props: { label: this.label } }, 'document')\n    }\n  },\n  {\n    label: '姓名',\n    create() {\n      return createBuiltinComponent({ props: { label: this.label } }, 'document')\n    }\n  },\n  {\n    label: '姓名组',\n    create() {\n      return createBuiltinComponentGroup(\n        { builtin: true, props: { label: this.label, position: { x: 0, y: 20 } } },\n        [\n          createBuiltinComponent({ props: { label: '姓名1' } }, 'document'),\n          createBuiltinComponent({ props: { label: '姓名2', position: { x: 20, y: 20 } } }, 'document')\n        ],\n        'document'\n      )\n    }\n  },\n  {\n    label: '筛选项',\n    create() {\n      return createBuiltinComponent(\n        {\n          name: 'builtin-select',\n          props: {\n            label: this.label,\n            options: [\n              { label: '测试1', value: '111' },\n              { label: '测试2', value: '222' },\n              { label: '测试3', value: '333' }\n            ]\n          }\n        },\n        'document'\n      )\n    }\n  }\n]\n\n/**\n * @type {Function}\n */\nlet resolvePromise = null\n\n/**\n * @param {Template.Builtin[]} data\n */\nfunction mockData(data) {\n  let index = 0\n\n  return data.map(function (item, i) {\n    const component = item.create(true)\n\n    component.uid = index++\n    component.id = createId(component.uid)\n    component.visible = true\n    component.props.position.x = 20\n    component.props.position.y = i * 100\n\n    if (component.children) {\n      component.children.forEach(function (item) {\n        item.uid = index++\n        item.id = createId(item.uid)\n      })\n    }\n\n    return component\n  })\n}\n\nexport default {\n  name: 'TemplateDocument',\n  components: {\n    BuiltinInput: () => import('../builtin/builtin-input.vue'),\n    BuiltinGroup: () => import('../builtin/builtin-group.vue'),\n    BuiltinSelect: () => import('../builtin/builtin-select.vue')\n  },\n  setup() {\n    const store = useStore()\n    store.size.name = 'A4'\n    const components = mockData(mockComponents)\n\n    components.forEach(function (item, i) {\n      store.components.set(i, item)\n      store.changes += 1\n    })\n\n    return { store }\n  },\n  data() {\n    return {\n      dialogVisible: false\n    }\n  },\n  computed: {\n    documentStyle() {\n      return {\n        borderLeftWidth: this.store.padding.left + 'mm',\n        borderTopWidth: this.store.padding.top + 'mm',\n        borderRightWidth: this.store.padding.right + 'mm',\n        borderBottomWidth: this.store.padding.bottom + 'mm',\n        width: this.store.size.width + 'px',\n        height: this.store.size.height + 'px'\n      }\n    }\n  },\n  methods: {\n    open() {\n      this.dialogVisible = true\n      return new Promise(resolve => {\n        resolvePromise = resolve\n      })\n    },\n    /**\n     * @param {'cancel' | 'ok'} type\n     */\n    action(type) {\n      this.dialogVisible = false\n      resolvePromise(type)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.template-document {\n  position: relative;\n  border: 0 solid #f2f2f2;\n  outline: none;\n  box-shadow: 0 0 8px 1px darken($color: #f2f2f2, $amount: 20%);\n}\n</style>\n","import Vue from 'vue'\nimport TemplateDocumentPromptConstructor from './render.vue'\n\nconst TemplateDocumentPrompt = Vue.extend(TemplateDocumentPromptConstructor)\n\n/**\n * @type {Vue|null}\n */\nlet templateDocumentPromptInstance = null\n\n/**\n * @returns {Promise<'ok'|'cancel'>}\n */\nexport default function templateDocumentPrompt() {\n  if (!templateDocumentPromptInstance) {\n    templateDocumentPromptInstance = new TemplateDocumentPrompt()\n    templateDocumentPromptInstance.$mount()\n\n    document.body.appendChild(templateDocumentPromptInstance.$el)\n  }\n\n  return templateDocumentPromptInstance.open()\n}\n","<template>\n  <app-data-view pagination>\n    <app-table-container>\n      <template slot=\"action\">\n        <router-link to=\"/template/action?type=create\">\n          <el-button size=\"small\" type=\"primary\">创建模板</el-button>\n        </router-link>\n        <el-button type=\"primary\" size=\"small\" @click=\"editDocument()\" style=\"margin-left: 10px\">编辑模板</el-button>\n      </template>\n\n      <el-table ref=\"table\" :data=\"table.data\" v-loading=\"table.loading\" height=\"100%\" stripe>\n        <el-table-column prop=\"date\" label=\"日期\" width=\"180\" />\n        <el-table-column prop=\"name\" label=\"姓名\" width=\"180\" />\n        <el-table-column prop=\"address\" label=\"地址\" />\n      </el-table>\n    </app-table-container>\n  </app-data-view>\n</template>\n\n<script>\nimport { request } from '@/utils/net'\nimport pageMixin from '@/mixins/page'\nimport templateDocumentPrompt from '@/views/template/components/template-document'\n\nfunction getData(param) {\n  console.log(param)\n  return request(\n    Array.from({ length: param.length || 20 }, (v, k) => ({\n      name: '王小虎',\n      address: `上海市普陀区金沙江路 151${k} 弄`\n    }))\n  )\n}\n\nexport default {\n  name: 'org-reportTemplate',\n  mixins: [\n    pageMixin({\n      request: getData,\n      immediate: false\n    })\n  ],\n  setup() {\n    const form = { mechanismId: null }\n\n    return {\n      form\n    }\n  },\n  created() {\n    this.form.mechanismId = this.currentMechanism.mechanismId\n    this.search()\n  },\n  methods: {\n    editDocument() {\n      return templateDocumentPrompt()\n    }\n  }\n}\n</script>\n"],"file":"static/js/reportTemplate.62ae4960.js"}