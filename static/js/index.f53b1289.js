var e=Object.defineProperty,t=(t,n,i)=>(((t,n,i)=>{n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i})(t,"symbol"!=typeof n?n+"":n,i),i);import{T as n,t as i,v as o,w as s,V as a,x as r,E as h,y as c,D as d,o as l,z as p,C as A,F as C,G as E,H as g,I as S,J as m,K as Q,n as w,Q as I,U as u,X as B,Y as x,Z as J,$ as U,R as y,q as R,P as F,S as K,A as f,a0 as k,O as q,a1 as b,a2 as v,a3 as V,a4 as G,a5 as N}from"./libs.ec5fd20d.js";import{n as D}from"./vendor.e75a9f0e.js";const M=new n;class P{constructor(e,n,i){t(this,"data",null),this.container=e,this.width=n,this.height=i,this.clickObjects=[],this.scene=null,this.camera=null,this.renderer=null,this.CSS2dRenderer=null,this.SVGRenderer=null,this.control=null,this.gui=null}init(e){this.data=e;const t=this,n=new y,i=new R;this.initScene(),this.initHelper(),this.initCamera(),this.initLight(),this.initRenderer(),this.initCSS2dRenderer(),this.initControl(),this.initCanvas(),this.resize=function(){t.renderer.setSize(window.innerWidth,window.innerHeight),t.CSS2dRenderer.setSize(window.innerWidth,window.innerHeight),t.camera.aspect=window.innerWidth/window.innerHeight,t.control.update(),t.camera.updateProjectionMatrix()},this.pointerdown=function(e){e.preventDefault(),i.x=e.clientX/t.renderer.domElement.clientWidth*2-1,i.y=-e.clientY/t.renderer.domElement.clientHeight*2+1,n.setFromCamera(i,t.camera);const o=n.intersectObjects(t.clickObjects);o.length>0&&t.onPointDown(o[0].object)},this.container.addEventListener("pointerdown",this.pointerdown),window.addEventListener("resize",this.resize),window.dispatchEvent(new Event("resize"))}initCamera(){this.camera=new F(75,this.width/this.height,.1,1e3),this.camera.position.set(8,8,8),this.camera.lookAt(0,0,0)}initScene(){this.scene=new K}initHelper(){const e=new f(50);this.gui=new k({title:"地图控制器"}),this.scene.add(e),document.body.appendChild(this.gui.domElement)}initControl(){const e=this;this.control=new q(this.camera,this.renderer.domElement),this.control.target.set(0,0,0),this.control.update(),this.change=function(){e.renderer.render(e.scene,e.camera),e.CSS2dRenderer.render(e.scene,e.camera)},this.control.addEventListener("change",this.change)}initRenderer(){const e=this;this.renderer=new b({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(13887227,1),this.renderer.setAnimationLoop((function(){e.renderer.render(e.scene,e.camera),e.CSS2dRenderer.render(e.scene,e.camera)})),this.container.appendChild(this.renderer.domElement)}initCSS2dRenderer(){this.CSS2dRenderer=new v,this.CSS2dRenderer.setSize(window.innerWidth,window.innerHeight),this.CSS2dRenderer.domElement.style.position="absolute",this.CSS2dRenderer.domElement.style.left="0",this.CSS2dRenderer.domElement.style.top="0",this.CSS2dRenderer.domElement.style.pointerEvents="none",this.container.appendChild(this.CSS2dRenderer.domElement)}initSVGRenderer(){}initLight(){const e=new V(13953021,4);this.scene.add(e);const t=new G(15264491,.2);t.position.set(0,10,5);const n=t.clone();n.position.set(0,10,-5);const i=t.clone();i.position.set(5,10,0);const o=t.clone();o.position.set(-5,10,0),this.scene.add(t),this.scene.add(n),this.scene.add(i),this.scene.add(o);const s=new N(t,2,16711680);this.scene.add(s);const a=this.gui.addFolder("平行光");a.add(t.position,"x",0,20).name("x轴"),a.add(t.position,"y",0,20).name("y轴"),a.add(t.position,"z",0,20).name("z轴"),a.add(t,"intensity",0,5).name("强度"),a.addColor(e,"color").onChange((function(t){e.color.set(t)})).name("环境光颜色")}initCanvas(){}animate(){}onPointDown(){}destroy(){window.removeEventListener("resize",this.resize),this.container.removeEventListener("pointerdown",this.pointerdown),this.control.removeEventListener("change",this.change),this.control.dispose(),this.gui.destroy(),this.renderer.dispose(),this.scene.clear(),this.data=null}}const T=i();class z extends P{constructor(){super(...arguments),t(this,"iconMap",M.load("/static/img/local-5a29b6c1.png")),t(this,"airplaneMap",M.load("data:image/png;base64,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")),t(this,"airplanes",[]),t(this,"process",0),t(this,"speed",5e-4),t(this,"flyCity",[["信阳市","郑州市"],["信阳市","鹤壁市"],["三门峡市","商丘市"],["三门峡市","洛阳市"],["鹤壁市","濮阳市"],["商丘市","鹤壁市"],["鹤壁市","南阳市"],["驻马店市","焦作市"],["信阳市","濮阳市"]]),t(this,"cityPoint",new Map)}initCanvas(){const e=this;this.map=e.createMap(e.data);const t=(new o).setFromObject(this.map),n=new s(t,16776960),i=t.getCenter(new a);this.map.position.x=this.map.position.x-i.x,this.map.position.y=this.map.position.y-i.y,e.scene.add(n),e.scene.add(this.map)}createMesh(e,t,n){const i=new r;e.forEach(((e,t)=>{const[n,o]=T(e);0===t?i.moveTo(n,-o):i.lineTo(n,-o)}));const o=new h(i,{depth:n,bevelEnabled:!1}),s=new c({color:t,emissive:0,roughness:.45,metalness:.8,transparent:!0,side:d});return new l(o,s)}createLine(e,t){const n=[];e.forEach((e=>{const[t,i]=T(e);n.push(new a(t,-i,0))}));const i=(new p).setFromPoints(n),o=new A({color:16777215}),s=new A({color:16777215}),r=new C(i,o),h=new C(i,s);return h.position.z=-1e-4,r.position.z=t+1e-4,[r,h]}createMap(e){const t=this,n=new E,i=e.features[0].properties.centroid;T.center(i).translate([0,0]);const o=function(e,t,n,i){const o=this.createMesh(e,t,n),s=this.createLine(e,n);i.add(o,...s),this.clickObjects.push(o)};return e.features.forEach((e=>{const i=new E,{coordinates:s,type:r}=e.geometry,{name:h,centroid:c,center:d}=e.properties,l=new g("hsl(\n        ".concat(233,",\n        ").concat(30*Math.random()+55,"%,\n        ").concat(30*Math.random()+55,"%)")).getHex(),p=.3*Math.random()+.3,A=c||d||[0,0],C=t.createLabel(h,A,p),S=t.createPoint(A,p);i.name=h;const[m,Q]=T(A);t.cityPoint.set(h,new a(m,-Q,p)),s.forEach((e=>{"MultiPolygon"===r&&e.forEach((e=>o.apply(t,[e,l,p,i]))),"Polygon"===r&&o.apply(t,[e,l,p,i])})),n.add(i,C,S)})),this.createFlayLine(n),n}createLabel(e,t,n){const[i,o]=T(t),s=document.createElement("label"),a=new S(s);return s.style.color="#fff",s.style.fontSize="12px",s.style.textShadow="1px 1px 2px #047cd6",s.textContent=e,a.scale.set(1.1,1.1,1.1),a.position.set(i,-o,n),a}createPoint(e,t){const n=new m({map:this.iconMap}),i=new Q(n),[o,s]=T(e);return i.scale.set(.3,.3,.3),i.position.set(o,-s,t+.2),i.renderOrder=1,i}onPointDown(e){const t=e.parent,n=this.map.children.filter((e=>"Group"===e.type));for(const{children:[i]}of n)i!==e&&(i.material.opacity=1);for(const i of t.children)i.material.opacity=.4}createFlyPoint(e){const t=new w({color:1722064,side:d}),n=new I(.1,200),i=new l(n,t);i.position.add(e);const o=new w({color:1722096,side:d,transparent:!0}),s=new u(.1,.15,500),a=new l(s,o);return a.position.add(e),[i,a]}createLineConnect(e,t){const[n,i]=this.createFlyPoint(e),[o,s]=this.createFlyPoint(t),r=new B(e,new a((e.x+t.x)/2,(e.y+t.y)/2,10*Math.random()*.6),t),h=r.getPoints(50),c=(new p).setFromPoints(h),l=new A({color:7226307,side:d});return[n,o,new C(c,l),i,s,r]}createPlane(e){const t=new w({map:this.airplaneMap,transparent:!0}),n=new x(.5,.5),i=new l(n,t);return i.position.add(e),i}createFlayLine(e){const t=[],n=[];for(const[i,o]of this.flyCity){const s=this.cityPoint.get(i),a=this.cityPoint.get(o),r=this.createPlane(s),[h,c,d,l,p,A]=this.createLineConnect(s,a),C=Math.atan2(a.x-s.x,a.y-s.y);r.rotateZ(-C),t.push(l,p),n.push([r,A]),e.add(h,c,d,l,p,r)}this.animate(t,n)}animate(e,t){this.airplanes=t;for(const n of e)J.fromTo(n.scale,{x:.1,y:.1,z:.1},{x:1.2,y:1.2,z:1.2,duration:3,repeat:-1,ease:U.easeInOut}),J.fromTo(n.material,{opacity:1},{opacity:0,duration:3,repeat:-1,ease:U.easeInOut});for(const[n,i]of this.airplanes)J.to(n.position,{onUpdate(){const e=J.getProperty(n.position,"progress")%1,t=i.getPoint(e),o=i.getTangent(e).normalize();n.position.copy(t);const s=new a(0,1,0).cross(o).normalize(),r=Math.acos(new a(0,1,0).dot(o));n.quaternion.setFromAxisAngle(s,r)},onStart(){J.set(n.position,{progress:0})},onComplete(){J.set(n.position,{progress:0})},progress:1,repeat:-1,duration:8,ease:"linear"})}}var L=function(){return(0,this._self._c)("div",{staticClass:"three-container"})},H=[];const W=D({name:"ThreeMap",async mounted(){const e=await fetch("https://geo.datav.aliyun.com/areas_v3/bound/410000_full.json").then((e=>e.json())),t=new z(this.$el,window.innerWidth,window.innerHeight);t.init(e),this.$on("hook:beforeDestroy",(function(){t.destroy()}))}},L,H,!1,null,null,null,null).exports;export{W as default};
//# sourceMappingURL=index.f53b1289.js.map
