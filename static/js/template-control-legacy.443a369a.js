!function(){function t(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,o,s,a,r=[],l=!0,h=!1;try{if(s=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=s.call(i)).done)&&(r.push(n.value),r.length!==e);l=!0);}catch(t){h=!0,o=t}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(h)throw o}}return r}}(t,i)||e(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}System.register(["./vendor-legacy.ddc66af0.js","./common-legacy.051f759c.js","./libs-legacy.774d107d.js","./components-legacy.c33fa5cb.js"],(function(i,n){"use strict";var o,s,a,r,l,h,c,f,p,u;return{setters:[function(t){o=t.K,s=t.g,a=t.d,r=t.o,l=t.l,h=t.n,c=t.i,f=t.x,p=t.t},function(t){u=t.A},null,null],execute:function(){var n=document.createElement("style");n.textContent=".template-control-mask{height:100%;position:absolute;width:100%;z-index:1}.template-control-mask,.template-control-point{border:1px solid transparent}.template-control-point{border-radius:50%;display:block;height:6px;position:absolute;width:6px;z-index:2}.template-control-point.top-left{cursor:nwse-resize;left:0;top:0;transform:translate(-50%,-50%)}.template-control-point.top-center{cursor:ns-resize;left:50%;top:0;transform:translate(-50%,-50%)}.template-control-point.top-right{cursor:nesw-resize;right:0;top:0;transform:translate(50%,-50%)}.template-control-point.center-left{cursor:ew-resize;left:0;top:50%;transform:translate(-50%,-50%)}.template-control-point.center-right{cursor:ew-resize;right:0;top:50%;transform:translate(50%,-50%)}.template-control-point.bottom-left{bottom:0;cursor:nesw-resize;left:0;transform:translate(-50%,50%)}.template-control-point.bottom-center{bottom:0;cursor:ns-resize;left:50%;transform:translate(-50%,50%)}.template-control-point.bottom-right{bottom:0;cursor:nwse-resize;right:0;transform:translate(50%,50%)}.template-control{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.template-control.lock .template-control-point{display:none}.template-control.visible .template-control-mask,.template-control.visible .template-control-point{border-color:var(--color-primary)}.template-control.visible .template-control-point{background-color:#fff}.template-control:not(.lock):active{cursor:grab}\n",document.head.appendChild(n);var d=new Map;function m(){var i=o("stageInstance"),n=s().proxy,h=a(!1),c=function(i){var o,s=function(t,i){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=e(t))||i&&t&&"number"==typeof t.length){n&&(t=n);var o=0,s=function(){};return{s:s,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return r=t.done,t},e:function(t){l=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(l)throw a}}}}(d);try{for(s.s();!(o=s.n()).done;){var a=t(o.value,2),r=a[0],l=a[1];n._uid!==r&&(h.value||(l.visible=!1))}}catch(c){s.e(c)}finally{s.f()}},f=function(t){t.shiftKey&&(h.value=!0)},p=function(t){h.value=!1};return r((function(){d.set(n._uid,n),n.$el.addEventListener("pointerdown",c),i.$el.addEventListener("keydown",f),i.$el.addEventListener("keyup",p)})),l((function(){d.delete(n._uid),n.$el.removeEventListener("pointerdown",c),i.$el.removeEventListener("keydown",f),i.$el.removeEventListener("keyup",p)})),{multiple:h}}var g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"template-control",class:{visible:t.visible,lock:t.lock},style:t.wrapperStyle,on:{pointerdown:function(e){return e.stopPropagation(),t.onPointerdown.apply(null,arguments)}}},[e("div",{staticClass:"template-control-mask"}),e("i",{staticClass:"template-control-point top-left",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("topLeft",e)}}}),e("i",{staticClass:"template-control-point top-center",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("topCenter",e)}}}),e("i",{staticClass:"template-control-point top-right",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("topRight",e)}}}),e("i",{staticClass:"template-control-point center-left",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("centerLeft",e)}}}),e("i",{staticClass:"template-control-point center-right",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("centerRight",e)}}}),e("i",{staticClass:"template-control-point bottom-left",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("bottomLeft",e)}}}),e("i",{staticClass:"template-control-point bottom-center",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("bottomCenter",e)}}}),e("i",{staticClass:"template-control-point bottom-right",on:{pointerdown:function(e){return e.stopPropagation(),t.onControlPointerdown("bottomRight",e)}}}),t._t("default")],2)},v={topLeft:function(t){var e=this.$el.getBoundingClientRect();this.stashPosition={x:e.left,y:e.top}},topCenter:function(t){var e=this.$el.getBoundingClientRect();this.stashPosition={x:e.left,y:e.top}},topRight:function(t){var e=this.$el.getBoundingClientRect(),i=this.scale/100;this.stashPosition={x:this.$el.offsetWidth*i+e.left,y:e.top}},centerLeft:function(t){var e=this.$el.getBoundingClientRect();this.stashPosition={x:e.left,y:e.top}},centerRight:function(t){var e=this.$el.getBoundingClientRect(),i=this.scale/100;this.stashPosition={x:this.$el.offsetWidth*i+e.left,y:this.$el.offsetHeight/2*i+e.top}},bottomLeft:function(t){var e=this.$el.getBoundingClientRect(),i=this.scale/100;this.stashPosition={x:e.left,y:this.$el.offsetHeight*i+e.top}},bottomCenter:function(t){var e=this.$el.getBoundingClientRect(),i=this.scale/100;this.stashPosition={x:this.$el.offsetWidth/2*i+e.left,y:this.$el.offsetHeight*i+e.top}},bottomRight:function(t){var e=this.$el.getBoundingClientRect(),i=this.scale/100;this.stashPosition={x:this.$el.offsetWidth*i+e.left,y:this.$el.offsetHeight*i+e.top}}},w={topLeft:function(t){if(this.stashPosition){var e=this.scale/100,i=this.stageInstance.$el.getBoundingClientRect(),n=t.pageY-i.top-this.offset.h*e,o=t.pageX-i.left-this.offset.w*e;o<=0&&(o=0);var s=this.data.w+(this.data.x-o/e);s<=this.miniSize.w?s=this.miniSize.w:this.data.x=o/e,n<=0&&(n=0);var a=this.data.h+(this.data.y-n/e);a<=this.miniSize.h?a=this.miniSize.h:this.data.y=n/e,this.data.h=a,this.data.w=s}},topCenter:function(t){if(this.stashPosition){var e=this.scale/100,i=this.stageInstance.$el.getBoundingClientRect(),n=t.pageY-i.top-this.offset.h*e;n<=0&&(n=0);var o=this.data.h+(this.data.y-n/e);o<=this.miniSize.h?o=this.miniSize.h:this.data.y=n/e,this.data.h=o}},topRight:function(t){if(this.stashPosition){var e=this.scale/100,i=this.stageInstance.$el.getBoundingClientRect(),n=this.initSize.w*e+(t.pageX-this.stashPosition.x);n<=this.miniSize.w*e&&(n=this.miniSize.w*e),this.$el.offsetLeft*e+n>=this.stageInstance.$el.clientWidth*e&&(n=(this.stageInstance.$el.clientWidth-this.$el.offsetLeft)*e),this.data.w=n/e;var o=t.pageY-i.top-this.offset.h*e;o<=0&&(o=0);var s=this.data.h+(this.data.y-o/e);s<=this.miniSize.h?s=this.miniSize.h:this.data.y=o/e,this.data.h=s}},centerLeft:function(t){if(this.stashPosition){var e=this.scale/100,i=this.stageInstance.$el.getBoundingClientRect(),n=t.pageX-i.left-this.offset.w*e;n<=0&&(n=0);var o=this.data.w+(this.data.x-n/e);o<=this.miniSize.w?o=this.miniSize.w:this.data.x=n/e,this.data.w=o}},centerRight:function(t){if(this.stashPosition){var e=this.scale/100,i=this.initSize.w*e+(t.pageX-this.stashPosition.x);i<=this.miniSize.w*e&&(i=this.miniSize.w*e),this.$el.offsetLeft*e+i>=this.stageInstance.$el.clientWidth*e&&(i=(this.stageInstance.$el.clientWidth-this.$el.offsetLeft)*e),this.data.w=i/e}},bottomLeft:function(t){if(this.stashPosition){var e=this.scale/100,i=this.stageInstance.$el.getBoundingClientRect(),n=t.pageX-i.left-this.offset.w*e,o=this.initSize.h*e+(t.pageY-this.stashPosition.y);o<=this.miniSize.h*e&&(o=this.miniSize.h*e),this.$el.offsetTop*e+o>=this.stageInstance.$el.clientHeight*e&&(o=this.stageInstance.$el.clientHeight*e-this.$el.offsetTop*e),this.data.h=o/e,n<=0&&(n=0);var s=this.data.w+(this.data.x-n/e);s<=this.miniSize.w?s=this.miniSize.w:this.data.x=n/e,this.data.w=s}},bottomCenter:function(t){if(this.stashPosition){var e=this.scale/100,i=this.initSize.h*e+(t.pageY-this.stashPosition.y);i<=this.miniSize.h*e&&(i=this.miniSize.h*e),this.$el.offsetTop*e+i>=this.stageInstance.$el.clientHeight*e&&(i=this.stageInstance.$el.clientHeight*e-this.$el.offsetTop*e),this.data.h=i/e}},bottomRight:function(t){var e=this.scale/100,i=this.initSize.w*e+(t.pageX-this.stashPosition.x),n=this.initSize.h*e+(t.pageY-this.stashPosition.y);i<=this.miniSize.w*e&&(i=this.miniSize.w*e),n<=this.miniSize.h*e&&(n=this.miniSize.h*e),this.$el.offsetLeft*e+i>=this.stageInstance.$el.clientWidth*e&&(i=(this.stageInstance.$el.clientWidth-this.$el.offsetLeft)*e),this.$el.offsetTop*e+n>=this.stageInstance.$el.clientHeight*e&&(n=(this.stageInstance.$el.clientHeight-this.$el.offsetTop)*e),this.data.w=i/e,this.data.h=n/e}},y={name:"TemplateControl",inject:["stageInstance"],props:{zIndex:{type:Number,required:!0},scale:{type:Number,default:1},position:{type:Object,required:!0},size:{type:Object,required:!0},value:{type:Boolean,required:!0},lock:{type:Boolean,required:!0}},setup:function(e,i){var n,o,h=s().proxy,d=c({get:function(){return e.value},set:function(t){i.emit("input",t)}}),g=m().multiple,v=a(null),y=f({x:e.position.x,y:e.position.y,h:e.size.h,w:e.size.w}),$=a(null),b=f({w:0,h:0}),z=f({w:0,h:0}),x=(n=h.stageInstance,o={w:0,h:0},r((function(){var e=t(u(n.$el),2),i=e[0],s=e[1];o.w=i,o.h=s})),o),S=function(t){if(!e.lock&&$.value){var n=e.scale/100;if(v.value)return w[v.value].call(h,t),i.emit("update:position",{x:y.x,y:y.y}),void i.emit("update:size",{w:y.w,h:y.h});var o=t.pageX-$.value.x,s=t.pageY-$.value.y;o<=0&&(o=0),s<=0&&(s=0),o>(h.stageInstance.$el.clientWidth-b.w)*n&&(o=(h.stageInstance.$el.clientWidth-b.w)*n),s>(h.stageInstance.$el.clientHeight-b.h)*n&&(s=(h.stageInstance.$el.clientHeight-b.h)*n),y.x=o/n,y.y=s/n,i.emit("update:position",{x:y.x,y:y.y}),i.emit("move",{x:y.x,y:y.y})}},C=function(t){$.value&&($.value=null,v.value=null,b.w=y.w,b.h=y.h,i.emit("moveEnd"),i.emit("resizeEnd"))},P=function(t){d.value=!1};return r((function(){p((function(){y.w=b.w=z.w=h.$el.offsetWidth,y.h=b.h=z.h=h.$el.offsetHeight,i.emit("update:size",{w:y.w,h:y.h})})),window.addEventListener("pointerdown",P),h.stageInstance.$el.addEventListener("pointermove",S),h.stageInstance.$el.addEventListener("pointerup",C)})),l((function(){window.removeEventListener("pointerdown",P),h.stageInstance.$el.removeEventListener("pointermove",S),h.stageInstance.$el.removeEventListener("pointerup",C)})),{offset:x,visible:d,multiple:g,pointType:v,initSize:b,miniSize:z,data:y,stashPosition:$,onPointerdown:function(t){var n=e.scale/100;d.value=!0,v.value=null,$.value={x:t.pageX-h.$el.offsetLeft*n,y:t.pageY-h.$el.offsetTop*n},i.emit("select",h),i.emit("moveStart",{x:y.x,y:y.y})}}},computed:{wrapperStyle:function(){return{zIndex:this.zIndex,left:this.data.x+"px",top:this.data.y+"px",width:this.data.w?this.data.w+"px":"auto",height:this.data.h?this.data.h+"px":"auto"}}},methods:{onControlPointerdown:function(t,e){this.pointType=t,v[t].apply(this,[e]),this.$emit("resizeStart",{w:this.data.w,h:this.data.h})}},watch:{value:function(t){this.visible=t},position:{deep:!0,handler:function(t){this.data.x=t.x,this.data.y=t.y}},size:{deep:!0,handler:function(t){this.data.w=t.w,this.data.h=t.h}}}};i("default",h(y,g,[],!1,null,null,null,null).exports)}}}))}();
//# sourceMappingURL=template-control-legacy.443a369a.js.map
