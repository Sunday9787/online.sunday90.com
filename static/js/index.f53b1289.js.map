{"version":3,"file":"index.f53b1289.js","sources":["../../../src/views/three/images/local.png","../../../src/views/three/map/map.js","../../../src/views/three/images/airplane.png","../../../src/views/three/map/index.vue"],"sourcesContent":["export default \"__VITE_ASSET__e18a8509__\"","import { gsap, Power1 } from 'gsap'\nimport * as THREE from 'three'\nimport * as d3 from 'd3'\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min'\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\nimport { CSS2DObject, CSS2DRenderer } from 'three/examples/jsm/renderers/CSS2DRenderer'\n\nimport localIcon from '../images/local.png'\nimport airplaneIcon from '../images/airplane.png'\n\nconst textureLoader = new THREE.TextureLoader()\n\nclass MapBase {\n  /**\n   * @type {Three.Map}\n   */\n  data = null\n\n  /**\n   * @param {HTMLElement} container\n   * @param {number} width\n   * @param {number} height\n   */\n  constructor(container, width, height) {\n    /**\n     * @type {HTMLElement}\n     * @protected\n     */\n    this.container = container\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.width = width\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.height = height\n\n    /**\n     * @type {THREE.Object3D[]}\n     * @protected\n     */\n    this.clickObjects = []\n\n    /**\n     * @protected\n     */\n    this.scene = null\n\n    /**\n     * @protected\n     */\n    this.camera = null\n\n    /**\n     * @protected\n     */\n    this.renderer = null\n\n    /**\n     * @protected\n     */\n    this.CSS2dRenderer = null\n\n    /**\n     * @protected\n     */\n    this.SVGRenderer = null\n\n    /**\n     * @protected\n     */\n    this.control = null\n\n    /**\n     * @protected\n     * @type {GUI}\n     */\n    this.gui = null\n  }\n\n  /**\n   * @param {Three.Map} map\n   */\n  init(map) {\n    this.data = map\n    const context = this\n\n    const raycaster = new THREE.Raycaster()\n    const mouse = new THREE.Vector2()\n\n    this.initScene()\n    this.initHelper()\n    this.initCamera()\n    this.initLight()\n    this.initRenderer()\n    this.initCSS2dRenderer()\n    // this.initSVGRenderer()\n    this.initControl()\n    this.initCanvas()\n\n    /**\n     * @private\n     */\n    this.resize = function () {\n      // 重置渲染器输出画布canvas尺寸\n      context.renderer.setSize(window.innerWidth, window.innerHeight)\n      context.CSS2dRenderer.setSize(window.innerWidth, window.innerHeight)\n      // context.SVGRenderer.setSize(window.innerWidth, window.innerHeight)\n      // 全屏情况下：设置观察范围长宽比aspect为窗口宽高比\n      context.camera.aspect = window.innerWidth / window.innerHeight\n\n      context.control.update()\n      // 渲染器执行render方法的时候会读取相机对象的投影矩阵属性projectionMatrix\n      // 但是不会每渲染一帧，就通过相机的属性计算投影矩阵(节约计算资源)\n      // 如果相机的一些属性发生了变化，需要执行 updateProjectionMatrix()方法更新相机的投影矩阵\n      context.camera.updateProjectionMatrix()\n    }\n\n    /**\n     * @private\n     * @param {MouseEvent} e\n     */\n    this.pointerdown = function (e) {\n      e.preventDefault()\n      mouse.x = (e.clientX / context.renderer.domElement.clientWidth) * 2 - 1\n      mouse.y = -(e.clientY / context.renderer.domElement.clientHeight) * 2 + 1\n\n      raycaster.setFromCamera(mouse, context.camera)\n\n      // 总结一下，这里必须装网格，mesh，装入组是没有效果的\n      // 所以我们将所有的盒子的网格放入对象就可以了\n      // 需要被监听的对象要存储在clickObjects中。\n      const intersects = raycaster.intersectObjects(context.clickObjects)\n\n      // console.log(intersects)\n      if (intersects.length > 0) {\n        context.onPointDown(intersects[0].object)\n      }\n    }\n\n    this.container.addEventListener('pointerdown', this.pointerdown)\n    window.addEventListener('resize', this.resize)\n    window.dispatchEvent(new Event('resize'))\n  }\n\n  /**\n   * 创建相机\n   * @protected\n   */\n  initCamera() {\n    this.camera = new THREE.PerspectiveCamera(75, this.width / this.height, 0.1, 1000)\n    this.camera.position.set(8, 8, 8)\n    this.camera.lookAt(0, 0, 0)\n  }\n\n  /**\n   * 创建场景\n   * @protected\n   */\n  initScene() {\n    this.scene = new THREE.Scene()\n  }\n\n  /**\n   * 创建坐标轴辅助线\n   * @protected\n   */\n  initHelper() {\n    const axesHelper = new THREE.AxesHelper(50)\n    this.gui = new GUI({ title: '地图控制器' })\n    this.scene.add(axesHelper)\n\n    document.body.appendChild(this.gui.domElement)\n  }\n\n  /**\n   *\n   * @protected\n   */\n  initControl() {\n    const context = this\n    this.control = new OrbitControls(this.camera, this.renderer.domElement)\n    this.control.target.set(0, 0, 0)\n\n    // controls 目标默认是 0 0 0 修改后需要手动更新\n    this.control.update()\n\n    /**\n     * @private\n     */\n    this.change = function () {\n      // OrbitControls 发生变化时 更新 渲染器\n      context.renderer.render(context.scene, context.camera)\n      context.CSS2dRenderer.render(context.scene, context.camera)\n      // context.SVGRenderer.render(context.scene, context.camera)\n    }\n\n    this.control.addEventListener('change', this.change)\n  }\n\n  /**\n   * 创建渲染器\n   * @protected\n   */\n  initRenderer() {\n    const context = this\n\n    const bootstrap = function () {\n      context.renderer.render(context.scene, context.camera)\n      context.CSS2dRenderer.render(context.scene, context.camera)\n      // context.SVGRenderer.render(context.scene, context.camera)\n    }\n\n    this.renderer = new THREE.WebGLRenderer({ antialias: true })\n    this.renderer.setPixelRatio(window.devicePixelRatio)\n    this.renderer.setClearColor(0xd3e6fb, 1)\n\n    this.renderer.setAnimationLoop(bootstrap)\n    this.container.appendChild(this.renderer.domElement)\n  }\n\n  /**\n   * 创建2d渲染器\n   * @protected\n   */\n  initCSS2dRenderer() {\n    this.CSS2dRenderer = new CSS2DRenderer()\n    this.CSS2dRenderer.setSize(window.innerWidth, window.innerHeight)\n    this.CSS2dRenderer.domElement.style.position = 'absolute'\n    this.CSS2dRenderer.domElement.style.left = '0'\n    this.CSS2dRenderer.domElement.style.top = '0'\n    this.CSS2dRenderer.domElement.style.pointerEvents = 'none'\n\n    this.container.appendChild(this.CSS2dRenderer.domElement)\n  }\n\n  /**\n   * 创建SVG渲染器\n   * @protected\n   */\n  initSVGRenderer() {\n    // this.SVGRenderer = new SVGRenderer()\n    // this.SVGRenderer.setSize(window.innerWidth, window.innerHeight)\n    // this.SVGRenderer.domElement.style.position = 'absolute'\n    // this.SVGRenderer.domElement.style.left = '0'\n    // this.SVGRenderer.domElement.style.top = '0'\n    // this.SVGRenderer.domElement.style.pointerEvents = 'none'\n    // this.container.appendChild(this.SVGRenderer.domElement)\n  }\n\n  /**\n   * 创建光源\n   * @protected\n   */\n  initLight() {\n    // 创建环境光光源\n    const ambientLight = new THREE.AmbientLight(0xd4e7fd, 4)\n    this.scene.add(ambientLight)\n\n    // 创建多个平行光\n    const directionalLight = new THREE.DirectionalLight(0xe8eaeb, 0.2)\n    directionalLight.position.set(0, 10, 5)\n    const directionalLight2 = directionalLight.clone()\n    directionalLight2.position.set(0, 10, -5)\n    const directionalLight3 = directionalLight.clone()\n    directionalLight3.position.set(5, 10, 0)\n    const directionalLight4 = directionalLight.clone()\n    directionalLight4.position.set(-5, 10, 0)\n    this.scene.add(directionalLight)\n    this.scene.add(directionalLight2)\n    this.scene.add(directionalLight3)\n    this.scene.add(directionalLight4)\n\n    const directionalLightHelper = new THREE.DirectionalLightHelper(directionalLight, 2, 0xff0000)\n    this.scene.add(directionalLightHelper)\n\n    const lightFolder = this.gui.addFolder('平行光')\n    lightFolder.add(directionalLight.position, 'x', 0, 20).name('x轴')\n    lightFolder.add(directionalLight.position, 'y', 0, 20).name('y轴')\n    lightFolder.add(directionalLight.position, 'z', 0, 20).name('z轴')\n    lightFolder.add(directionalLight, 'intensity', 0, 5).name('强度')\n\n    lightFolder\n      .addColor(ambientLight, 'color')\n      .onChange(function (value) {\n        ambientLight.color.set(value)\n      })\n      .name('环境光颜色')\n  }\n\n  /**\n   * 开始绘制\n   * @abstract\n   * @protected\n   */\n  initCanvas() {}\n\n  /**\n   * 开始动画\n   * @abstract\n   * @protected\n   */\n  animate() {}\n\n  /**\n   * 点击事件\n   * @abstract\n   * @protected\n   */\n  onPointDown() {}\n\n  destroy() {\n    window.removeEventListener('resize', this.resize)\n    this.container.removeEventListener('pointerdown', this.pointerdown)\n    this.control.removeEventListener('change', this.change)\n    this.control.dispose()\n    this.gui.destroy()\n    this.renderer.dispose()\n    this.scene.clear()\n    this.data = null\n  }\n}\n\n/**\n * d3.geoMercator()是一个地理投影函数，用于将地球表面的经纬度坐标映射到二维平面上。\n */\nconst offsetXY = d3.geoMercator()\n\nexport default class ThreeMap extends MapBase {\n  /**\n   * @private\n   */\n  iconMap = textureLoader.load(localIcon)\n\n  /**\n   * @private\n   */\n  airplaneMap = textureLoader.load(airplaneIcon)\n\n  /**\n   * @private\n   * @type {Array<[THREE.Mesh, THREE.CubicBezierCurve3]>}\n   */\n  airplanes = []\n\n  /**\n   * @private\n   */\n\n  process = 0\n\n  /**\n   * @private\n   */\n  speed = 0.0005\n\n  /**\n   * @private\n   * @type {Array<[string, string]>}\n   */\n  flyCity = [\n    ['信阳市', '郑州市'],\n    ['信阳市', '鹤壁市'],\n    ['三门峡市', '商丘市'],\n    ['三门峡市', '洛阳市'],\n    ['鹤壁市', '濮阳市'],\n    ['商丘市', '鹤壁市'],\n    ['鹤壁市', '南阳市'],\n    ['驻马店市', '焦作市'],\n    ['信阳市', '濮阳市']\n  ]\n\n  /**\n   * @private\n   * @type {Map<string, THREE.Vector3>}\n   */\n  cityPoint = new Map()\n\n  initCanvas() {\n    const context = this\n\n    this.map = context.createMap(context.data)\n\n    const box = new THREE.Box3().setFromObject(this.map)\n    const boxHelper = new THREE.Box3Helper(box, 0xffff00)\n\n    const center = box.getCenter(new THREE.Vector3())\n\n    this.map.position.x = this.map.position.x - center.x\n    this.map.position.y = this.map.position.y - center.y\n\n    context.scene.add(boxHelper)\n    context.scene.add(this.map)\n  }\n\n  /**\n   * 创建 地图几何\n   * @param {[number, number][]} data\n   * @param {number} color\n   * @param {number} color\n   */\n  createMesh(data, color, depth) {\n    const shape = new THREE.Shape()\n    data.forEach((item, idx) => {\n      const [x, y] = offsetXY(item)\n      if (idx === 0) shape.moveTo(x, -y)\n      else shape.lineTo(x, -y)\n    })\n\n    const shapeGeometry = new THREE.ExtrudeGeometry(shape, {\n      depth,\n      bevelEnabled: false\n    })\n\n    const shapeMaterial = new THREE.MeshStandardMaterial({\n      color,\n      emissive: 0x000000,\n      roughness: 0.45,\n      metalness: 0.8,\n      transparent: true,\n      side: THREE.DoubleSide\n    })\n\n    const mesh = new THREE.Mesh(shapeGeometry, shapeMaterial)\n    return mesh\n  }\n\n  /**\n   * 创建 地图边界线\n   * @param {[number, number][]} data\n   * @param {number} color\n   * @param {number} color\n   */\n  createLine(data, depth) {\n    const points = []\n    data.forEach(item => {\n      const [x, y] = offsetXY(item)\n      points.push(new THREE.Vector3(x, -y, 0))\n    })\n    const lineGeometry = new THREE.BufferGeometry().setFromPoints(points)\n    const upLineMaterial = new THREE.LineBasicMaterial({ color: 0xffffff })\n    const downLineMaterial = new THREE.LineBasicMaterial({ color: 0xffffff })\n\n    const upLine = new THREE.Line(lineGeometry, upLineMaterial)\n    const downLine = new THREE.Line(lineGeometry, downLineMaterial)\n    downLine.position.z = -0.0001\n    upLine.position.z = depth + 0.0001\n    return [upLine, downLine]\n  }\n\n  /**\n   * @param {Three.Map} data\n   *\n   */\n  createMap(data) {\n    const context = this\n    const map = new THREE.Group()\n    const center = data.features[0].properties.centroid\n    /**\n     * offsetXY.center(center)是用于指定投影的中心点，这个中心点决定了投影的中心位置，地图上的所有要素都将以该点为中心进行投影转换。\n     * .translate([0, 0])是指定投影的平移量。这里的 [0, 0] 表示在平面坐标系中的 x 和 y 方向上都没有平移，也就是将地图的投影结果放置在平面坐标系的原点位置。\n     */\n    offsetXY.center(center).translate([0, 0])\n\n    /**\n     * @this {ThreeMap}\n     * @param {[number, number][]} coordinate\n     * @param {number} color\n     * @param {number} depth\n     * @param {THREE.Group} unit\n     */\n    const handle = function (coordinate, color, depth, unit) {\n      const mesh = this.createMesh(coordinate, color, depth)\n      const line = this.createLine(coordinate, depth)\n      unit.add(mesh, ...line)\n      this.clickObjects.push(mesh)\n    }\n\n    data.features.forEach(feature => {\n      const unit = new THREE.Group()\n\n      const { coordinates, type } = feature.geometry\n      const { name, centroid, center } = feature.properties\n      const color = new THREE.Color(`hsl(\n        ${233},\n        ${Math.random() * 30 + 55}%,\n        ${Math.random() * 30 + 55}%)`).getHex()\n      const depth = Math.random() * 0.3 + 0.3\n      const point = centroid || center || [0, 0]\n      const label = context.createLabel(name, point, depth)\n      const icon = context.createPoint(point, depth)\n      unit.name = name\n\n      const [flayX, flayY] = offsetXY(point)\n      context.cityPoint.set(name, new THREE.Vector3(flayX, -flayY, depth))\n\n      coordinates.forEach(coordinate => {\n        if (type === 'MultiPolygon') coordinate.forEach(item => handle.apply(context, [item, color, depth, unit]))\n        if (type === 'Polygon') handle.apply(context, [coordinate, color, depth, unit])\n      })\n\n      map.add(unit, label, icon)\n    })\n\n    this.createFlayLine(map)\n\n    return map\n  }\n\n  /**\n   * @param {string} name\n   * @param {[number,number]} point\n   * @param {number} depth\n   */\n  createLabel(name, point, depth) {\n    const [x, y] = offsetXY(point)\n    const div = document.createElement('label')\n    const label = new CSS2DObject(div)\n    div.style.color = '#fff'\n    div.style.fontSize = '12px'\n    div.style.textShadow = '1px 1px 2px #047cd6'\n    div.textContent = name\n\n    label.scale.set(1.1, 1.1, 1.1)\n    label.position.set(x, -y, depth)\n\n    return label\n  }\n\n  /**\n   * @param {[number,number]} point\n   * @param {number} depth\n   */\n  createPoint(point, depth) {\n    const material = new THREE.SpriteMaterial({ map: this.iconMap })\n    const sprite = new THREE.Sprite(material)\n    const [x, y] = offsetXY(point)\n    sprite.scale.set(0.3, 0.3, 0.3)\n\n    sprite.position.set(x, -y, depth + 0.2)\n    sprite.renderOrder = 1\n    return sprite\n  }\n\n  /**\n   * @param {THREE.Mesh} unit\n   */\n  onPointDown(unit) {\n    const parent = unit.parent\n    const group = this.map.children.filter(item => item.type === 'Group')\n\n    for (const {\n      children: [mesh]\n    } of group) {\n      if (mesh === unit) continue\n      mesh.material.opacity = 1\n    }\n\n    for (const item of parent.children) {\n      item.material.opacity = 0.4\n    }\n  }\n\n  /**\n   * @param {THREE.Vector3} point\n   */\n  createFlyPoint(point) {\n    /**\n     * 创建 飞行起点圆\n     */\n    const material = new THREE.MeshBasicMaterial({ color: 0x1a46d0, side: THREE.DoubleSide })\n    const circleGeometry = new THREE.CircleGeometry(0.1, 200)\n    const circle = new THREE.Mesh(circleGeometry, material)\n    circle.position.add(point)\n\n    /**\n     * 创建圆环\n     */\n    const ringMaterial = new THREE.MeshBasicMaterial({ color: 0x1a46f0, side: THREE.DoubleSide, transparent: true })\n    const ringGeometry = new THREE.RingGeometry(0.1, 0.15, 500)\n    const ring = new THREE.Mesh(ringGeometry, ringMaterial)\n    ring.position.add(point)\n\n    return [circle, ring]\n  }\n\n  /**\n   * @param {THREE.Vector3} startPosition\n   * @param {THREE.Vector3} endPosition\n   */\n  createLineConnect(startPosition, endPosition) {\n    const [start, startRing] = this.createFlyPoint(startPosition)\n    const [end, endRing] = this.createFlyPoint(endPosition)\n\n    const curve = new THREE.QuadraticBezierCurve3(\n      startPosition,\n      new THREE.Vector3(\n        (startPosition.x + endPosition.x) / 2,\n        (startPosition.y + endPosition.y) / 2,\n        Math.random() * 10 * 0.6\n      ),\n      endPosition\n    )\n\n    const points = curve.getPoints(50)\n    const lineGeometry = new THREE.BufferGeometry().setFromPoints(points)\n    const lineMaterial = new THREE.LineBasicMaterial({ color: 0x6e43c3, side: THREE.DoubleSide })\n    const line = new THREE.Line(lineGeometry, lineMaterial)\n\n    return [start, end, line, startRing, endRing, curve]\n  }\n\n  /**\n   * @param {THREE.Vector3} position\n   */\n  createPlane(position) {\n    const material = new THREE.MeshBasicMaterial({ map: this.airplaneMap, transparent: true })\n    const geometry = new THREE.PlaneGeometry(0.5, 0.5)\n    const plane = new THREE.Mesh(geometry, material)\n    plane.position.add(position)\n\n    return plane\n  }\n\n  /**\n   * @param {THREE.Group} group\n   */\n  createFlayLine(group) {\n    /**\n     * @type {Array<THREE.Mesh>}\n     */\n    const rings = []\n    /**\n     * @type {Array<[THREE.Sprite, THREE.CubicBezierCurve3]>}\n     */\n    const airplanes = []\n\n    for (const [startCity, endCity] of this.flyCity) {\n      const startPosition = this.cityPoint.get(startCity)\n      const endPosition = this.cityPoint.get(endCity)\n      const plane = this.createPlane(startPosition)\n      const [start, end, line, startRing, endRing, curve] = this.createLineConnect(startPosition, endPosition)\n\n      // 旋转飞机角度\n      const rad = Math.atan2(endPosition.x - startPosition.x, endPosition.y - startPosition.y)\n\n      plane.rotateZ(-rad)\n\n      rings.push(startRing, endRing)\n      airplanes.push([plane, curve])\n      group.add(start, end, line, startRing, endRing, plane)\n    }\n\n    this.animate(rings, airplanes)\n  }\n\n  /**\n   * @param {THREE.Mesh[]} rings\n   * @param {Array<[THREE.Mesh, THREE.CubicBezierCurve3]>} airplanes\n   */\n  animate(rings, airplanes) {\n    this.airplanes = airplanes\n\n    for (const mesh of rings) {\n      gsap.fromTo(\n        mesh.scale,\n        { x: 0.1, y: 0.1, z: 0.1 },\n        { x: 1.2, y: 1.2, z: 1.2, duration: 3, repeat: -1, ease: Power1.easeInOut }\n      )\n      gsap.fromTo(mesh.material, { opacity: 1 }, { opacity: 0, duration: 3, repeat: -1, ease: Power1.easeInOut })\n    }\n\n    for (const [shape, curve] of this.airplanes) {\n      gsap.to(shape.position, {\n        onUpdate() {\n          const t = gsap.getProperty(shape.position, 'progress') % 1\n          const position = curve.getPoint(t)\n          const tangent = curve.getTangent(t).normalize()\n          shape.position.copy(position)\n\n          // 计算物体的旋转\n          const axis = new THREE.Vector3(0, 1, 0).cross(tangent).normalize()\n          const angle = Math.acos(new THREE.Vector3(0, 1, 0).dot(tangent))\n          shape.quaternion.setFromAxisAngle(axis, angle)\n        },\n        onStart() {\n          gsap.set(shape.position, { progress: 0 }) // 初始进度\n        },\n        onComplete() {\n          gsap.set(shape.position, { progress: 0 }) // 动画完成后重置进度\n        },\n        progress: 1,\n        repeat: -1,\n        duration: 8,\n        ease: 'linear'\n      })\n    }\n  }\n}\n","export default \"data:image/png;base64,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\"","<template lang=\"pug\">\n.three-container\n</template>\n\n<script>\nimport Map from './map'\n\n/**\n * @returns {Promise<Three.Map>}\n */\nfunction getData() {\n  return fetch('https://geo.datav.aliyun.com/areas_v3/bound/410000_full.json').then(response => response.json())\n}\n\nexport default {\n  name: 'ThreeMap',\n  async mounted() {\n    const data = await getData()\n    const map = new Map(this.$el, window.innerWidth, window.innerHeight)\n\n    map.init(data)\n\n    this.$on('hook:beforeDestroy', function () {\n      map.destroy()\n    })\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.three-container {\n  position: relative;\n  height: 100%;\n}\n</style>\n"],"names":["textureLoader","THREE.TextureLoader","MapBase","constructor","container","width","height","__publicField","this","clickObjects","scene","camera","renderer","CSS2dRenderer","SVGRenderer","control","gui","init","map","data","context","raycaster","THREE.Raycaster","mouse","THREE.Vector2","initScene","initHelper","initCamera","initLight","initRenderer","initCSS2dRenderer","initControl","initCanvas","resize","setSize","window","innerWidth","innerHeight","aspect","update","updateProjectionMatrix","pointerdown","e","preventDefault","x","clientX","domElement","clientWidth","y","clientY","clientHeight","setFromCamera","intersects","intersectObjects","length","onPointDown","object","addEventListener","dispatchEvent","Event","THREE.PerspectiveCamera","position","set","lookAt","THREE.Scene","axesHelper","THREE.AxesHelper","GUI","title","add","document","body","appendChild","OrbitControls","target","change","render","THREE.WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setClearColor","setAnimationLoop","CSS2DRenderer","style","left","top","pointerEvents","initSVGRenderer","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","directionalLight2","clone","directionalLight3","directionalLight4","directionalLightHelper","THREE.DirectionalLightHelper","lightFolder","addFolder","name","addColor","onChange","value","color","animate","destroy","removeEventListener","dispose","clear","offsetXY","d3.geoMercator","ThreeMap","super","arguments","load","Map","createMap","box","THREE.Box3","setFromObject","boxHelper","THREE.Box3Helper","center","getCenter","THREE.Vector3","createMesh","depth","shape","THREE.Shape","forEach","item","idx","moveTo","lineTo","shapeGeometry","THREE.ExtrudeGeometry","bevelEnabled","shapeMaterial","THREE.MeshStandardMaterial","emissive","roughness","metalness","transparent","side","THREE.DoubleSide","THREE.Mesh","createLine","points","push","lineGeometry","THREE.BufferGeometry","setFromPoints","upLineMaterial","THREE.LineBasicMaterial","downLineMaterial","upLine","THREE.Line","downLine","z","THREE.Group","features","properties","centroid","translate","handle","coordinate","unit","mesh","line","feature","coordinates","type","geometry","THREE.Color","concat","random","getHex","Math","point","label","createLabel","icon","createPoint","flayX","flayY","cityPoint","apply","createFlayLine","div","createElement","CSS2DObject","fontSize","textShadow","textContent","scale","material","THREE.SpriteMaterial","iconMap","sprite","THREE.Sprite","renderOrder","parent","group","children","filter","opacity","createFlyPoint","THREE.MeshBasicMaterial","circleGeometry","THREE.CircleGeometry","circle","ringMaterial","ringGeometry","THREE.RingGeometry","ring","createLineConnect","startPosition","endPosition","start","startRing","end","endRing","curve","THREE.QuadraticBezierCurve3","getPoints","lineMaterial","createPlane","airplaneMap","THREE.PlaneGeometry","plane","rings","airplanes","startCity","endCity","flyCity","get","rad","atan2","rotateZ","gsapWithCSS","fromTo","duration","repeat","ease","Power1","easeInOut","gsap","to","onUpdate","t","getProperty","getPoint","tangent","getTangent","normalize","copy","axis","cross","angle","acos","dot","quaternion","setFromAxisAngle","onStart","progress","onComplete","mounted","fetch","then","response","json","$el","$on"],"mappings":"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"}