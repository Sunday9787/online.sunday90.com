{"version":3,"file":"dashboard.7d41376d.js","sources":["../../../src/views/dashboard/components/sample.vue","../../../src/views/dashboard/components/report.vue","../../../src/views/dashboard/components/statistics.vue","../../../src/views/dashboard/index.vue?chunkName=dashboard"],"sourcesContent":["<template lang=\"pug\">\napp-table-container\n  template(slot='action')\n    el-button(size=\"small\" type=\"primary\" @click=\"exportCases('导出病例')\") 导出病例\n    el-button(size=\"small\" type=\"primary\" @click=\"exportExcel('导出EXCEL')\") 导出EXCEL\n    el-button(size=\"small\" type=\"primary\" @click=\"expertConsultation('专家会诊')\") 专家会诊\n    el-button(size=\"small\" type=\"primary\" @click=\"distributionCases('病例分配')\") 病例分配\n    el-button(size=\"small\" type=\"primary\" @click=\"deleteCases('删除病例')\") 删除病例\n\n  el-table(\n    ref=\"table\"\n    :data=\"page.table.data\"\n    v-loading=\"page.table.loading\"\n    height=\"100%\"\n    stripe\n    @selection-change=\"selectionChange\")\n    el-table-column(type=\"selection\")\n    el-table-column(prop=\"date\" label=\"日期\" width=\"180\")\n    el-table-column(prop=\"name\" label=\"姓名\" width=\"180\")\n    el-table-column(prop=\"address\", label=\"地址\")\n</template>\n\n<script>\nimport { reactive } from 'vue'\nimport createLine from '@/utils/line'\n\nexport function useSample() {\n  const form = reactive({\n    mechanismId: '',\n    /** 样本编号 */\n    patientNo: '',\n    /** 上传时间 */\n    startTime: '',\n    endTime: '',\n    /** 会诊状态 0 | 1 */\n    hasExpertPatient: 0,\n    /** 是否转交 0 | 1 */\n    hasTransferPatient: 0,\n    /** 转交状态 */\n    transferStatus: -1\n  })\n\n  const expertPatientOptions = Object.freeze([\n    { label: '全部', value: -1 },\n    { label: '是', value: 1 },\n    { label: '否', value: 0 }\n  ])\n\n  const transferPatientOptions = Object.freeze([\n    { label: '全部', value: -1 },\n    { label: '是', value: 1 },\n    { label: '否', value: 0 }\n  ])\n\n  return {\n    form,\n    expertPatientOptions,\n    transferPatientOptions\n  }\n}\n\nconst line = createLine(function (config) {\n  config.hook(function () {\n    if (this.selection.length) {\n      return true\n    }\n\n    this.$message.error('请至少选择一个')\n  })\n})\n\nexport default {\n  name: 'dashboard-sample',\n  inject: ['page'],\n  data() {\n    return {\n      selection: []\n    }\n  },\n  methods: {\n    /**\n     * 导出病例\n     */\n    exportCases: line(function (e) {\n      console.log(e)\n    }),\n    /**\n     * 导出EXCEL\n     */\n    exportExcel: line(function (e) {\n      console.log(e)\n    }),\n    /**\n     * 专家会诊\n     */\n    expertConsultation: line(function (e) {\n      console.log(e)\n    }),\n    /**\n     * 病例分配\n     */\n    distributionCases: line(function (e) {\n      console.log(e)\n    }),\n    /**\n     * 删除病例\n     */\n    deleteCases: line(function (e) {\n      console.log(e)\n    }),\n    selectionChange(val) {\n      this.selection = val\n    }\n  }\n}\n</script>\n","<template lang=\"pug\">\napp-table-container\n  template(slot=\"action\")\n    el-button(type=\"primary\" size=\"small\") 导出LIS\n    el-button(type=\"primary\" size=\"small\") 导出EXCEL\n    el-button(@click=\"exposePDF()\" type=\"primary\" size=\"small\") 导出PDF\n  el-table(stripe height=\"100%\" v-loading=\"page.table.loading\" :data=\"page.table.data\" ref=\"table\")\n    template(v-for=\"head in tableHead\")\n      el-table-column(v-if=\"head.on || !head.prop\" v-bind=\"head\" :key=\"head.prop\")\n        app-table-widget(\n          v-if=\"!head.prop\"\n          :text=\"head.label\"\n          :data=\"tableHead\"\n          storage-key=\"dashboard-report\"\n          slot=\"header\")\n</template>\n\n<script>\nimport { reactive } from 'vue'\n\nexport function useReport() {\n  const form = reactive({\n    mechanismId: '',\n    /** 样本编号 */\n    patientNo: '',\n    /** 审核进度 0 | 1 */\n    tabType: 0,\n    /** 导出 Lis 0 | 1 */\n    hasExportLis: 0,\n    /** 完成时间 */\n    finishDateEndTime: '',\n    finishDateStartTime: ''\n  })\n\n  const tabTypeOptions = Object.freeze([\n    { label: '全部', value: -1 },\n    { label: '未提交', value: 1 },\n    { label: '待审核', value: 0 }\n  ])\n\n  const exportLisOptions = Object.freeze([\n    { label: '全部', value: -1 },\n    { label: '是', value: 1 },\n    { label: '否', value: 0 }\n  ])\n\n  return { form, tabTypeOptions, exportLisOptions }\n}\n\nexport default {\n  name: 'dashboard-report',\n  inject: ['page'],\n  data() {\n    return {\n      tableHead: [\n        {\n          on: true,\n          fixed: true,\n          label: '日期',\n          prop: 'date',\n          width: '180'\n        },\n        {\n          on: true,\n          required: true,\n          label: '姓名',\n          prop: 'name',\n          width: '380'\n        },\n        {\n          on: true,\n          required: true,\n          label: '姓名名',\n          prop: 'named',\n          width: '380'\n        },\n        {\n          on: true,\n          label: '地址',\n          prop: 'address',\n          width: '380'\n        },\n        {\n          label: '设置',\n          fixed: 'right',\n          width: '150'\n        }\n      ]\n    }\n  },\n  created() {\n    this.$nextTick(function () {\n      console.log(this.page)\n    })\n  },\n  methods: {\n    exposePDF() {\n      console.log(this)\n    }\n  }\n}\n</script>\n","<template lang=\"pug\">\napp-table-container\n  el-table(stripe height=\"100%\" v-loading=\"page.table.loading\" :data=\"page.table.data\" ref=\"table\")\n    el-table-column(width=\"180\" label=\"日期\" prop=\"date\")\n    el-table-column(width=\"180\" label=\"姓名\" prop=\"name\")\n    el-table-column(label=\"地址\" prop=\"address\")\n</template>\n\n<script>\nimport { reactive } from 'vue'\n\nexport function useStatistics() {\n  const form = reactive({\n    mechanismId: '',\n    /** 样本编号 */\n    patientNo: '',\n    /** 删除状态 -1 0 1 */\n    delFlag: -1,\n    /** 提交时间 */\n    submitDateEnd: '',\n    submitDateStart: ''\n  })\n\n  const delFlagOptions = Object.freeze([\n    { label: '全部', value: -1 },\n    { label: '是', value: 1 },\n    { label: '否', value: 0 }\n  ])\n\n  return { form, delFlagOptions }\n}\n\nexport default {\n  name: 'dashboard-statistics',\n  inject: ['page'],\n  setup() {}\n}\n</script>\n","<template lang=\"pug\">\napp-page\n  app-card\n    app-form-tab(@change=\"tabChange\" v-model=\"activeName\")\n      app-form-tab-pane(title=\"样本管理\" name=\"sample\" v-slot=\"{ visible }\")\n        app-form-collapse(:visible=\"visible\")\n          el-form(label-width=\"80px\" size=\"small\" :model=\"sampleForm\" inline ref=\"sample\")\n            el-form-item(prop=\"patientNo\" label=\"样本编号\")\n              el-input(@input=\"search()\" v-model=\"sampleForm.patientNo\")\n            el-form-item(prop=\"startTime\" label=\"上传时间\")\n              el-date-picker(@change=\"search()\" end-placeholder=\"结束日期\" start-placeholder=\"开始日期\" v-model=\"uploadTime\" type=\"daterange\")\n            el-form-item(prop=\"hasExpertPatient\" label=\"会诊状态\")\n              el-select(@change=\"search()\" default-first-option v-model=\"sampleForm.hasExpertPatient\")\n                el-option(\n                  v-for=\"item in expertPatientOptions\"\n                  :value=\"item.value\"\n                  :label=\"item.label\"\n                  :key=\"item.value\")\n            el-form-item(prop=\"transferStatus\" label=\"转交状态\")\n              el-select(default-first-option v-model=\"sampleForm.transferStatus\")\n                el-option(\n                  v-for=\"item in transferPatientOptions\"\n                  :value=\"item.value\"\n                  :label=\"item.label\"\n                  :key=\"item.value\")\n          el-button(@click=\"resetForm('sample')\" size=\"small\" slot=\"action\") 重置\n      app-form-tab-pane(title=\"样本统计\" name=\"statistics\" v-slot=\"{ visible }\")\n        app-form-collapse(:visible=\"visible\")\n          el-form(label-width=\"80px\" size=\"small\" :model=\"statisticsForm\" inline ref=\"statistics\")\n            el-form-item(prop=\"patientNo\" label=\"样本编号\")\n              el-input(@input=\"search()\" v-model=\"statisticsForm.patientNo\")\n            el-form-item(prop=\"delFlag\" label=\"删除状态\")\n              el-select(@change=\"search()\" default-first-option v-model=\"statisticsForm.delFlag\")\n                el-option(\n                  v-for=\"item in delFlagOptions\"\n                  :value=\"item.value\"\n                  :label=\"item.label\"\n                  :key=\"item.value\")\n            el-form-item(prop=\"submitDateStart\" label=\"提交时间\")\n              el-date-picker(\n                @change=\"search()\"\n                end-placeholder=\"结束日期\"\n                start-placeholder=\"开始日期\"\n                v-model=\"submitTime\"\n                type=\"daterange\")\n          el-button(@click=\"resetForm('statistics')\" size=\"small\" slot=\"action\") 重置\n      app-form-tab-pane(title=\"报告报告统计\" name=\"report\" v-slot=\"{ visible }\")\n        app-form-collapse(:visible=\"visible\")\n          el-form(label-width=\"80px\" size=\"small\" :model=\"reportForm\" inline ref=\"report\")\n            el-form-item(prop=\"patientNo\" label=\"样本编号\")\n              el-input(@input=\"search()\" v-model=\"reportForm.patientNo\")\n            el-form-item(prop=\"hasExportLis\" label=\"导出Lsi\")\n              el-select(@change=\"search()\" default-first-option v-model=\"reportForm.hasExportLis\")\n                el-option(\n                  v-for=\"item in exportLisOptions\"\n                  :value=\"item.value\"\n                  :label=\"item.label\"\n                  :key=\"item.value\")\n            el-form-item(prop=\"tabType\" label=\"审核进度\")\n              el-select(@change=\"search()\" default-first-option v-model=\"reportForm.tabType\")\n                el-option(\n                  v-for=\"item in tabTypeOptions\"\n                  :value=\"item.value\"\n                  :label=\"item.label\"\n                  :key=\"item.value\")\n            el-form-item(prop=\"finishDateEndTime\" label=\"完成时间\")\n              el-date-picker(change=\"search()\" end-placeholder=\"结束日期\" start-placeholder=\"开始日期\" v-model=\"finishTime\" type=\"daterange\")\n          el-button(@click=\"resetForm('report')\" size=\"small\" slot=\"action\") 重置\n  app-data-view(pagination)\n    keep-alive\n      component(:is=\"activeName\")\n</template>\n\n<script>\nimport Mock from 'mockjs'\nimport { plainToInstance } from 'class-transformer'\nimport { request } from '@/utils/net'\nimport pageMixin from '@/mixins/page'\n\nimport sample, { useSample } from './components/sample.vue'\nimport report, { useReport } from './components/report.vue'\nimport statistics, { useStatistics } from './components/statistics.vue'\n\nfunction getData({ length = 10 }) {\n  const data = Mock.mock({\n    [`data|10-${length}`]: [\n      {\n        date: '@date',\n        name: '@cname',\n        address: '@province@city@county'\n      }\n    ]\n  })\n  return request(data.data)\n}\n\n;(async function () {\n  /**\n   * @param {0|1|null} status\n   */\n  function formatStatus(status) {\n    if (status === null) return '未初始化'\n    if (status > 0) return '启用'\n    return '禁用'\n  }\n\n  class TableItem {\n    date = ''\n\n    name = ''\n\n    address = ''\n\n    /**\n     * @type {0|1|null}\n     */\n    status = null\n\n    lastModified = ''\n\n    get statusName() {\n      return formatStatus(this.status)\n    }\n  }\n\n  const response = await getData({ length: 15 })\n  const data = plainToInstance(TableItem, response)\n  console.log(data)\n})()\n\nexport default {\n  name: 'DashboardIndex',\n  mixins: [\n    pageMixin({\n      immediate: false,\n      request: getData,\n      timeFieldMap: {\n        uploadTime: ['startTime', 'endTime'],\n        submitTime: ['submitDateStart', 'submitDateEnd'],\n        finishTime: ['finishDateEndTime', 'finishDateStartTime']\n      }\n    })\n  ],\n  components: {\n    sample,\n    report,\n    statistics\n  },\n  setup() {\n    const { form: sampleForm, expertPatientOptions, transferPatientOptions } = useSample()\n    const { form: reportForm, tabTypeOptions, exportLisOptions } = useReport()\n    const { form: statisticsForm, delFlagOptions } = useStatistics()\n    const formMap = {\n      sample: sampleForm,\n      statistics: statisticsForm,\n      report: reportForm\n    }\n\n    return {\n      formMap,\n      statisticsForm,\n      sampleForm,\n      reportForm,\n      expertPatientOptions,\n      transferPatientOptions,\n      delFlagOptions,\n      tabTypeOptions,\n      exportLisOptions\n    }\n  },\n  data() {\n    return {\n      activeName: 'sample'\n    }\n  },\n  computed: {\n    form() {\n      return this.formMap[this.activeName]\n    }\n  },\n  created() {\n    this.form.mechanismId = this.currentMechanism.mechanismId\n    this.search()\n\n    this.$nextTick(function () {\n      console.log(this.table)\n    })\n  },\n  methods: {\n    tabChange(tab) {\n      this.resetForm(tab)\n    }\n  }\n}\n</script>\n"],"names":["line","createLine","config","hook","this","selection","length","$message","error","name","inject","data","methods","exportCases","e","console","log","exportExcel","expertConsultation","distributionCases","deleteCases","selectionChange","val","tableHead","on","fixed","label","prop","width","required","created","$nextTick","page","exposePDF","setup","getData","Mock","mock","concat","date","address","request","response","plainToInstance","constructor","__publicField","statusName","status","mixins","pageMixin","immediate","timeFieldMap","uploadTime","submitTime","finishTime","components","sample","report","statistics","form","sampleForm","expertPatientOptions","transferPatientOptions","reactive","mechanismId","patientNo","startTime","endTime","hasExpertPatient","hasTransferPatient","transferStatus","Object","freeze","value","reportForm","tabTypeOptions","exportLisOptions","tabType","hasExportLis","finishDateEndTime","finishDateStartTime","statisticsForm","delFlagOptions","delFlag","submitDateEnd","submitDateStart","formMap","activeName","computed","currentMechanism","search","table","tabChange","tab","resetForm"],"mappings":"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"}