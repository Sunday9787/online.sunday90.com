import{n as e,_ as t}from"./vendor.e75a9f0e.js";import{M as i}from"./libs.ec5fd20d.js";const s=i.mock({id:"@id",title:"@cword(48)",price:"@integer(1,100)","album|5":["@image(1200x1200, @color)"],specs:[{id:1,attr:"颜色",select:"",value:[{id:0,label:"红色"},{id:1,label:"绿色"},{id:2,label:"蓝色"},{id:3,label:"紫色"}],img:"@image(800x800, @color, @first)"},{id:2,attr:"尺码",select:"",value:[{id:0,label:"M"},{id:1,label:"L"},{id:2,label:"XL"}],img:"@image(800x800, @color, @first)"},{id:3,attr:"版型",select:"",value:[{id:0,label:"宽松"},{id:1,label:"紧致"}],img:"@image(800x800, @color, @first)"}]}),l=[{id:0,spec:[{id:1,label:"颜色",value:"红色"},{id:2,label:"尺码",value:"L"},{id:3,label:"版型",value:"紧致"}]},{id:1,spec:[{id:1,label:"颜色",value:"绿色"},{id:2,label:"尺码",value:"L"},{id:3,label:"版型",value:"紧致"}]},{id:3,spec:[{id:1,label:"颜色",value:"紫色"},{id:2,label:"尺码",value:"XL"},{id:3,label:"版型",value:"宽松"}]}];class a{constructor(e){this.vertex=e,this.quantity=this.vertex.length,this.adjoinMatrix=new Map(Array(this.quantity**2).fill(0).entries())}setAdjoinVertex(e,t){const i=this.vertex.indexOf(e),s=this;t.forEach((function(e){const t=s.vertex.indexOf(e);s.adjoinMatrix.set(i*s.quantity+t,1)}))}getVertexCol(e){const t=this.vertex.indexOf(e),i=[];for(let s=0;s<this.vertex.length;s++)i.push(this.adjoinMatrix.get(this.quantity*s+t));return i}getColSum(e){const t=e.map((e=>this.getVertexCol(e))),i=[];for(let s=0;s<this.vertex.length;s++){const e=t.map((e=>e[s])).reduce((function(e,t){return e+t}),0);i.push(e)}return i}getCollection(e){const t=this.getColSum(e),i=[];return t.forEach(((e,t)=>{e&&this.vertex[t]&&i.push(this.vertex[t])})),i}getUnions(e){const t=this.getColSum(e),i=[];return t.forEach(((t,s)=>{t>=e.length&&this.vertex[s]&&i.push(this.vertex[s])})),i}}class r extends a{constructor(e,t){super(e.reduce((function(e,t){return e.concat(t.value.map((e=>e.label)))}),[])),this.specList=e,this.specCombinationList=t,this.init()}init(){this.initSpec()}initSpec(){const e=this;this.specCombinationList.forEach((function(t){const i=t.spec.map((e=>e.value));let s=i[0],l=0;for(;l<i.length;){const t=i.filter((e=>e!==s));e.setAdjoinVertex(s,t),l++,s=i[l]}}))}getSpecsOptions(e){let t=null;return t=e.some(Boolean)?this.getUnions(e.filter(Boolean)):this.getCollection(this.vertex),t}}var n=function(){var e=this,t=e._self._c;return t("section",[t("app-card",[t("section",{staticClass:"good-container"},[t("keep-alive",[e.currentSpec?t("el-carousel",{key:"preview",attrs:{interval:5e3,height:"600px",arrow:"always"}},e._l(e.detail.specs,(function(e,i){return t("el-carousel-item",{key:i},[t("el-image",{staticStyle:{width:"100%",height:"600px"},attrs:{src:e.img,fit:"contain",alt:"图片"}})],1)})),1):t("el-carousel",{key:"album",attrs:{interval:5e3,height:"600px",arrow:"always"}},e._l(e.detail.album,(function(e,i){return t("el-carousel-item",{key:i},[t("el-image",{staticStyle:{width:"100%",height:"600px"},attrs:{src:e,fit:"contain",alt:"图片"}})],1)})),1)],1),t("div",{staticClass:"good-title"},[e._v(e._s(e.detail.title))]),t("ul",{staticClass:"good-spec"},e._l(e.detail.specs,(function(i){return t("li",{key:i.id,staticClass:"good-spec__item"},[t("label",{staticClass:"good-spec-title"},[e._v(e._s(i.attr))]),t("spec-group",{model:{value:i.select,callback:function(t){e.$set(i,"select",t)},expression:"item.select"}},e._l(i.value,(function(i){return t("spec-item",{key:i.id,attrs:{disabled:e.optionSpecs.indexOf(i.label)<0,label:i.label}},[e._v(e._s(i.label))])})),1)],1)})),0),t("div",[t("el-button",{staticClass:"fluid",attrs:{type:"primary"}},[e._v("购买")])],1)],1)]),t("app-card",[t("h3",[e._v("已选择")]),t("p",[e._v(e._s(e.currentSpec||"-"))])])],1)},o=[];function c(e){const t=new Map;return e.forEach((function(e){const i=e.spec.map((e=>e.value)).join(",");t.set(i,e)})),t}const u=e({name:"ProductBuy",props:{id:{type:Number,required:!0}},components:{specGroup:()=>t((()=>import("./spec-group.2aae5e86.js")),["static/js/spec-group.2aae5e86.js","static/js/vendor.e75a9f0e.js","static/js/libs.ec5fd20d.js","static/css/libs-2b70db29.css","static/css/spec-group-7479064b.css"]),specItem:()=>t((()=>import("./spec-item.2d6099ac.js")),["static/js/spec-item.2d6099ac.js","static/js/vendor.e75a9f0e.js","static/js/libs.ec5fd20d.js","static/css/libs-2b70db29.css","static/css/spec-item-628630d9.css"])},data:()=>({detail:s,specCombinationList:l,specCombinationMap:c(l),specMatrix:new r(s.specs,l)}),computed:{form(){const e=[];return this.detail.specs.forEach((function(t){t.select&&e.push(t.select)})),e},optionSpecs(){return this.specMatrix.getSpecsOptions(this.form)},currentSpec(){if(this.form.length){const e=this.form.join(",");return this.specCombinationMap.get(e)}return null}},mounted(){}},n,o,!1,null,null,null,null).exports;export{u as default};
//# sourceMappingURL=productBuy.7733f17d.js.map
